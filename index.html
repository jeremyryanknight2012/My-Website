<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>StudyMath</title>
  <style>
    :root{
      --bg:#0b1220; --panel:#0f1a33; --panel2:#0c162e;
      --text:#e8eefc; --muted:#a9b6d6;
      --border:rgba(255,255,255,.10);
      --hover:rgba(255,255,255,.07);
      --active:rgba(255,255,255,.12);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:var(--bg);
      color:var(--text);
    }

    .app{
      display:grid;
      grid-template-rows:56px 1fr;
      grid-template-columns:260px 1fr;
      height:100vh;
    }

    header{
      grid-column:1/-1;
      display:flex;
      align-items:center;
      padding:0 16px;
      border-bottom:1px solid var(--border);
      background:linear-gradient(180deg,var(--panel),var(--panel2));
    }

    .brand{font-weight:800;font-size:18px}

    aside{
      border-right:1px solid var(--border);
      background:rgba(255,255,255,.02);
      padding:14px;
    }

    .nav-title{
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:.12em;
      color:var(--muted);
      margin:6px 10px 10px;
    }

    .nav{display:flex;flex-direction:column;gap:6px}

    .nav a{
      display:flex;
      align-items:center;
      gap:10px;
      text-decoration:none;
      color:var(--text);
      padding:10px 12px;
      border-radius:10px;
      border:1px solid transparent;
      transition:.15s;
    }

    .nav a:hover{background:var(--hover);border-color:var(--border)}
    .nav a.active{background:var(--active);border-color:var(--border)}

    .dot{
      width:10px;height:10px;border-radius:999px;
      background:rgba(255,255,255,.35);
      flex:0 0 auto;
    }

    main{
      padding:18px;
      overflow-y:auto;
      overflow-x:hidden;
    }

    .card{
      max-width:100%;
      background:rgba(255,255,255,.03);
      border:1px solid var(--border);
      border-radius:16px;
      padding:18px;
    }

    .card h1{margin:0 0 8px;font-size:22px}
    .card p{margin:0;color:var(--muted);line-height:1.5}

    /* Netflix-style row */
    .row{margin-top:18px}
    .row-title{
      margin:0 0 10px;
      font-size:13px;
      text-transform:uppercase;
      letter-spacing:.12em;
      color:var(--muted);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }

    .row-actions{display:flex;gap:8px;align-items:center}
    .small-btn{
      appearance:none;
      border:1px solid var(--border);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:8px 10px;
      border-radius:10px;
      font-weight:800;
      cursor:pointer;
      font-size:12px;
      text-decoration:none;
      display:inline-block;
    }
    .small-btn:hover{background:rgba(255,255,255,.10)}

    .scroller{
      display:flex;
      gap:12px;
      overflow-x:auto;
      padding-bottom:10px;
      scroll-snap-type:x mandatory;
      -webkit-overflow-scrolling:touch;
    }

    .scroller::-webkit-scrollbar{height:10px}
    .scroller::-webkit-scrollbar-track{background:rgba(255,255,255,.04);border-radius:999px}
    .scroller::-webkit-scrollbar-thumb{background:rgba(255,255,255,.14);border-radius:999px}
    .scroller::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.20)}

    .game{
      scroll-snap-align:start;
      flex:0 0 240px;
      background:rgba(255,255,255,.03);
      border:1px solid var(--border);
      border-radius:16px;
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:10px;
      transition:transform .12s ease, background .12s ease;
    }

    .game:hover{transform:translateY(-2px);background:rgba(255,255,255,.05)}

    .thumb{
      width:100%;
      height:160px;
      object-fit:contain;
      background:rgba(255,255,255,.04);
      border-radius:12px;
      border:1px solid var(--border);
    }

    .game-name{margin:0;font-weight:800;font-size:14px}

    .play-link{
      appearance:none;
      border:1px solid var(--border);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      font-weight:800;
      text-decoration:none;
      text-align:center;
      display:inline-block;
      cursor:pointer;
    }
    .play-link:hover{background:rgba(255,255,255,.10)}

    .empty{
      color:var(--muted);
      font-size:13px;
      margin:0;
    }
  </style>
</head>
<body>
<div class="app">
  <header><div class="brand">StudyMath</div></header>

  <aside>
    <div class="nav-title">Pages</div>
    <nav class="nav" id="nav">
      <a href="./"><span class="dot"></span><span>Home</span></a>
      <a href="./games.html"><span class="dot"></span><span>Games</span></a>
      <a href="./requests.html"><span class="dot"></span><span>Requests</span></a>
    </nav>
  </aside>

  <main>
    <div class="card">
      <h1>Welcome to StudyMath</h1>
      <p>Play games and pick up right where you left off.</p>

      <div class="row" style="margin-top:16px;">
        <div class="row-title">
          <span>Recently Played</span>
          <div class="row-actions">
            <button class="small-btn" id="clearRecent" type="button">Clear</button>
            <a class="small-btn" href="./games.html">Go to Games</a>
          </div>
        </div>

        <p class="empty" id="recentEmpty">No recently played games yet. Go play something!</p>
        <div class="scroller" id="recentScroller" style="display:none;"></div>
      </div>
    </div>
  </main>
</div>

<script>
  // ===== Active nav highlight =====
  const nav = document.getElementById("nav");
  const here = (location.pathname || "").replace(/\/+$/, "");
  [...nav.querySelectorAll("a")].forEach(a => {
    const href = (a.getAttribute("href") || "").replace(/\/+$/, "");
    // basic match: home "./" or exact file
    if ((href === "./" && (here.endsWith("/My-Website") || here.endsWith("/My-Website/index.html") || here === "")) ||
        (href !== "./" && here.endsWith(href.replace("./","/")))) {
      a.classList.add("active");
    }
  });

  // ===== Recently Played =====
  const RECENT_KEY = "studymath_recent_v1";
  const recentScroller = document.getElementById("recentScroller");
  const recentEmpty = document.getElementById("recentEmpty");
  const clearRecent = document.getElementById("clearRecent");

  // Use ABSOLUTE urls so links never break
  const BASE = "https://jeremyryanknight2012.github.io/My-Website";

  const GAME_CATALOG = [
    { id:"stealabrainrot", title:"Steal a Brainrot", thumb:`${BASE}/thumbnails/stealabrainrot.png`, url:`${BASE}/games/stealabrainrot.html` },
    { id:"1v1lol", title:"1v1.LOL", thumb:`${BASE}/thumbnails/1v1lol.png`, url:`${BASE}/games/1v1lol.html` },
    { id:"drivemad", title:"Drive Mad", thumb:`${BASE}/thumbnails/drivemad.png`, url:`${BASE}/games/drivemad.html` },
    { id:"retrobowl", title:"Retro Bowl", thumb:`${BASE}/thumbnails/retrobowl.png`, url:`${BASE}/games/retrobowl.html` },

    { id:"10minutestilldawn", title:"10 Minutes Till Dawn", thumb:`${BASE}/thumbnails/10minutestilldawn.png`, url:`${BASE}/games/10minutestilldawn.html` },
    { id:"amandatheadventurer", title:"Amanda the Adventurer", thumb:`${BASE}/thumbnails/amandatheadventurer.png`, url:`${BASE}/games/amandatheadventurer.html` },
    { id:"bankrobbery2", title:"Bank Robbery 2", thumb:`${BASE}/thumbnails/bankrobbery2.png`, url:`${BASE}/games/bankrobbery2.html` },
    { id:"baseballbros", title:"Baseball Bros", thumb:`${BASE}/thumbnails/baseballbros.png`, url:`${BASE}/games/baseballbros.html` },
    { id:"basketbros", title:"Basket Bros", thumb:`${BASE}/thumbnails/basketbros.png`, url:`${BASE}/games/basketbros.html` },
    { id:"retrobowlcollege", title:"Retro Bowl College", thumb:`${BASE}/thumbnails/retrobowlcollege.png`, url:`${BASE}/games/retrobowlcollege.html` }
  ];

  const GAME_BY_ID = Object.fromEntries(GAME_CATALOG.map(g => [g.id, g]));

  function safeParse(json, fallback) {
    try { return JSON.parse(json); } catch { return fallback; }
  }

  function getRecentIds() {
    const raw = localStorage.getItem(RECENT_KEY);
    const arr = safeParse(raw, []);
    return Array.isArray(arr) ? arr : [];
  }

  function renderRecent() {
    const ids = getRecentIds().filter(id => GAME_BY_ID[id]).slice(0, 10);
    recentScroller.innerHTML = "";

    if (ids.length === 0) {
      recentEmpty.style.display = "block";
      recentScroller.style.display = "none";
      return;
    }

    recentEmpty.style.display = "none";
    recentScroller.style.display = "flex";

    ids.forEach(id => {
      const g = GAME_BY_ID[id];

      const card = document.createElement("div");
      card.className = "game";

      card.innerHTML = `
        <img class="thumb" src="${g.thumb}" alt="${g.title}">
        <p class="game-name">${g.title}</p>
        <a class="play-link" href="${g.url}">Play</a>
      `;

      recentScroller.appendChild(card);
    });
  }

  clearRecent.addEventListener("click", () => {
    localStorage.removeItem(RECENT_KEY);
    renderRecent();
  });

  renderRecent();

  // If you play a game in another tab, update automatically
  window.addEventListener("storage", (e) => {
    if (e.key === RECENT_KEY) renderRecent();
  });
</script>
</body>
</html>
