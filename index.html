<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SME</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* THEME VARIABLES */
:root {
    --bg: #ffffff;
    --text: #000000;
    --panel: #222;
}
.dark {
    --bg: #111;
    --text: #fff;
    --panel: #333;
}

body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: Arial, sans-serif;
    overflow-x: hidden;
    transition: background .3s, color .3s;
}

/* PERFORMANCE MODE */
.performance * {
    image-rendering: pixelated;
    filter: blur(0.25px);
    transition: none !important;
}

/* HEADER */
header {
    background: #222;
    color: white;
    padding: 12px 18px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* SETTINGS PANEL */
#settings-panel {
    position: fixed;
    top: 0;
    left: 0;
    width: 260px;
    height: 100%;
    background: var(--panel);
    color: white;
    padding: 20px;
    transform: translateX(-100%);
    transition: 0.35s ease;
    z-index: 9999;
}
#settings-panel.open { transform: translateX(0); }

/* SECTIONS */
.section {
    padding: 25px 40px 40px;
    margin-bottom: 30px;
    border-bottom: 2px solid #444;
}

/* SCROLLER ROW */
.row-container {
    margin-top: 20px;
    position: relative;
}
.row {
    display: flex;
    gap: 15px;
    overflow-x: auto;
    scroll-behavior: smooth;
    padding-bottom: 10px;
}

/* CARDS */
.card {
    min-width: 240px;
    background: #222;
    color: white;
    padding: 15px;
    border-radius: 8px;
    cursor: pointer;
    transition: .2s;
}
.card:hover {
    transform: scale(1.06);
}
.card h2 { margin: 0 0 8px; }

.download-btn {
    background: #4CAF50;
    color: white;
    padding: 10px;
    border-radius: 6px;
    display: inline-block;
}

/* EMBED VIEW */
#embed-container {
    position: fixed;
    inset: 0;
    background: black;
    display: none;
    z-index: 9000;
}
#embed-frame {
    width: 100%;
    height: 100%;
    border: none;
}

#home-btn {
    position: fixed;
    bottom: 12px;
    left: 12px;
    padding: 12px 18px;
    background: #444;
    color: white;
    border-radius: 6px;
    cursor: pointer;
    display: none;
    z-index: 9999;
}

/* TRANSITION */
#transition-screen {
    position: fixed;
    inset: 0;
    background: white;
    opacity: 0;
    pointer-events: none;
    transition: opacity .6s ease;
    z-index: 99999;
}
#transition-screen.active { opacity: 1; }
</style>
</head>
<body>

<!-- TRANSITION -->
<div id="transition-screen"></div>

<!-- SETTINGS PANEL -->
<div id="settings-panel">
    <h2>Settings</h2>
    <button onclick="toggleDarkMode()">Dark Mode</button>
    <button onclick="togglePerformance()">Performance Mode</button>
    <hr>
    <button onclick="exportSettings()">Export Settings</button>
    <input type="file" onchange="importSettings(event)">
</div>

<!-- FIXED HEADER (NO BROKEN LAYOUT ANYMORE) -->
<header>
    <div id="site-title">SME</div>
    <div style="flex: 1;"></div>
    <button id="settings-button" onclick="openSettings()">Settings</button>
</header>

<!-- SECTION 1: DOWNLOADS -->
<section class="section">
    <h1>Game Downloads</h1>

    <div class="row-container">
        <div class="row">

            <div class="card">
                <h2>Minecraft</h2>
                <a class="download-btn" href="https://drive.google.com/uc?export=download&id=1lQnwB_6FZ-wPXQPg3NxcBTEVJRFxY00u">Download</a>
            </div>

            <div class="card">
                <h2>Slope</h2>
                <a class="download-btn" href="https://drive.google.com/uc?export=download&id=1IS41Lxh7Yuu4QZh7AcyhUGng_PuhwiEP">Download</a>
            </div>

            <div class="card">
                <h2>Subway Surfers</h2>
                <a class="download-btn" href="https://drive.google.com/uc?export=download&id=10UUI0JaXaQk5eKckAz_-o74s0aVdiL0J">Download</a>
            </div>

        </div>
    </div>
</section>

<!-- SECTION 2: GAMES -->
<section class="section">
    <h1>Games</h1>

    <div class="row-container">
        <div class="row">

            <!-- SLIME RANCHER -->
            <div class="card" onclick="openEmbedURL('https://jeremy4401.github.io/slime-rancher/')">
                <h2>Slime Rancher</h2>
                <button class="download-btn">Play</button>
            </div>

            <!-- BUCKSHOT ROULETTE (PROPERLY FIXED) -->
            <div class="card" onclick="openEmbedURL('https://cdn.jsdelivr.net/gh/genizy/web-port@main/buckshot-roulette/index.html')">
                <h2>Buckshot Roulette</h2>
                <button class="download-btn">Play</button>
            </div>

        </div>
    </div>
</section>

<!-- SECTION 3: THEATER -->
<section class="section">
    <h1>Theater</h1>

    <div class="row-container">
        <div class="row">
            <div class="card" onclick="openEmbedURL('https://jeremy4401.github.io/SME-Theater')">
                <h2>Theater</h2>
                <button class="download-btn">Watch</button>
            </div>
        </div>
    </div>
</section>

<!-- EMBED SYSTEM -->
<div id="embed-container"><iframe id="embed-frame"></iframe></div>
<div id="home-btn" onclick="closeEmbed()">Home</div>

<script>

/* SETTINGS */
function openSettings(){ document.getElementById("settings-panel").classList.toggle("open"); }
function toggleDarkMode(){ document.body.classList.toggle("dark"); }
function togglePerformance(){ document.body.classList.toggle("performance"); }

/* EXPORT / IMPORT */
function exportSettings(){
    const data = {
        dark: document.body.classList.contains("dark"),
        performance: document.body.classList.contains("performance")
    };
    const blob = new Blob([JSON.stringify(data)], {type:"application/json"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "settings.json";
    a.click();
}
function importSettings(event){
    const file = event.target.files[0];
    if (!file) return;
    const r = new FileReader();
    r.onload = e => {
        const s = JSON.parse(e.target.result);
        document.body.classList.toggle("dark", s.dark);
        document.body.classList.toggle("performance", s.performance);
    };
    r.readAsText(file);
}

/* TRANSITION */
function transition(callback){
    let t=document.getElementById("transition-screen");
    t.classList.add("active");
    setTimeout(()=>{ callback(); setTimeout(()=>t.classList.remove("active"),300); },300);
}

/* EMBED */
function openEmbedURL(url){
    transition(()=>{
        document.getElementById("embed-frame").src=url;
        document.getElementById("embed-container").style.display="block";
        document.getElementById("home-btn").style.display="block";
    });
}
function closeEmbed(){
    transition(()=>{
        document.getElementById("embed-container").style.display="none";
        document.getElementById("embed-frame").src="";
        document.getElementById("home-btn").style.display="none";
    });
}

</script>
</body>
</html>
